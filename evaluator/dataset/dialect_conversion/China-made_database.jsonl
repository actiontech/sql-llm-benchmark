{"case_id": "1", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE OR REPLACE PROCEDURE GETEMPLOYEESTATS(p_dept_id IN NUMBER, p_result OUT CLOB) IS TYPE stats_rec IS RECORD (total_emp NUMBER, avg_salary NUMBER, max_salary NUMBER, active_projects NUMBER); TYPE p_result_rec IS RECORD (employee_id NUMBER, last_name VARCHAR2(50), salary NUMBER(8,2)); v_stats stats_rec; v_result p_result_rec; v_cursor SYS_REFCURSOR; v_sql VARCHAR2(1000); v_dept_name VARCHAR2(50); BEGIN SELECT department_name INTO v_dept_name FROM DEPARTMENTS WHERE department_id = p_dept_id; SELECT COUNT(*), AVG(salary), MAX(salary) INTO v_stats.total_emp, v_stats.avg_salary, v_stats.max_salary FROM EMPLOYEES WHERE department_id = p_dept_id; SELECT COUNT(*) INTO v_stats.active_projects FROM PROJECTS WHERE department_id = p_dept_id AND status = 'ACTIVE'; v_sql := 'SELECT * FROM (SELECT employee_id, last_name, salary FROM employees WHERE department_id = :1 ORDER BY salary DESC) WHERE ROWNUM <= 5'; OPEN v_cursor FOR v_sql USING p_dept_id; p_result := '{  \"department\": \"' || v_dept_name || '\",  \"total_employees\": ' || v_stats.total_emp || ',  \"salary_stats\": {    \"average\": ' || v_stats.avg_salary || ',    \"max\": ' || v_stats.max_salary || '  },  \"active_projects\": ' || v_stats.active_projects || ',  \"top_earners\": ['; LOOP FETCH v_cursor INTO v_result; EXIT WHEN v_cursor%NOTFOUND; p_result := p_result || '    {\"id\": ' || v_result.employee_id || ', \"name\": \"' || v_result.last_name || '\", \"salary\": ' || v_result.salary || '},'; END LOOP; p_result := RTRIM(p_result, ',') || '  ]}'; CLOSE v_cursor; EXCEPTION WHEN NO_DATA_FOUND THEN p_result := '{\"error\": \"Department not found\"}'; WHEN OTHERS THEN p_result := '{\"error\": \"' || SQLERRM || '\"}'; END;"}
{"case_id": "2", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE TABLE t1 (c1 NUMBER, c2 VARCHAR2(100), c3 DATE);"}
{"case_id": "3", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "INSERT INTO t1 VALUES (1, 'Hello OceanBase', TO_DATE('2025-01-01', 'yyyy-mm-dd'));"}
{"case_id": "4", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT c1, NVL(c2, 'is null') FROM t1;"}
{"case_id": "5", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE USER ob_user IDENTIFIED BY \"Password123\";"}
{"case_id": "6", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT ename, sal, RANK() OVER (PARTITION BY deptno ORDER BY sal DESC) FROM emp;"}
{"case_id": "7", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE OR REPLACE PROCEDURE p_test (p_id IN NUMBER, p_name OUT VARCHAR2) AS BEGIN SELECT ename INTO p_name FROM emp WHERE empno = p_id; END;"}
{"case_id": "8", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT employee_id, start_date, end_date, job_id FROM job_history MINUS SELECT employee_id, hire_date, NULL, job_id FROM employees;"}
{"case_id": "9", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE PUBLIC SYNONYM emp_synonym FOR scott.emp;"}
{"case_id": "10", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT /*+ INDEX(employees emp_department_ix) */ * FROM employees WHERE department_id = 10;"}
{"case_id": "11", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "DECLARE v_count NUMBER; BEGIN SELECT COUNT(*) INTO v_count FROM user_tables WHERE table_name = 'EMP'; DBMS_OUTPUT.PUT_LINE('Count is: ' || v_count); END;"}
{"case_id": "12", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT listagg(ename, ';') WITHIN GROUP (ORDER BY hiredate) FROM emp WHERE deptno = 30;"}
{"case_id": "13", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT LPAD(' ', 2 * (LEVEL - 1)) || ename FROM emp START WITH mgr IS NULL CONNECT BY PRIOR empno = mgr;"}
{"case_id": "14", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE OR REPLACE PROCEDURE autonomous_proc IS PRAGMA AUTONOMOUS_TRANSACTION; BEGIN INSERT INTO audit_log (log_msg) VALUES ('An autonomous action occurred'); COMMIT; END;"}
{"case_id": "15", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE TABLE range_partitioned_sales (sale_id NUMBER, sale_date DATE) PARTITION BY RANGE (sale_date) (PARTITION p1 VALUES LESS THAN (TO_DATE('2024-01-01','YYYY-MM-DD')), PARTITION p2 VALUES LESS THAN (MAXVALUE));"}
{"case_id": "16", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE OR REPLACE PACKAGE BODY emp_mgmt AS PROCEDURE hire(p_name VARCHAR2) IS BEGIN INSERT INTO emp(ename) VALUES(p_name); END; FUNCTION get_count RETURN NUMBER IS v_cnt NUMBER; BEGIN SELECT COUNT(*) INTO v_cnt FROM emp; RETURN v_cnt; END; END emp_mgmt;"}
{"case_id": "17", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "CREATE MATERIALIZED VIEW mv_emp_summary BUILD IMMEDIATE REFRESH COMPLETE ON DEMAND AS SELECT deptno, COUNT(*) as emp_count FROM emp GROUP BY deptno;"}
{"case_id": "18", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "SELECT CAST(MULTISET(SELECT ename FROM emp WHERE deptno = d.deptno) AS SYS.ODCIVARCHAR2LIST) as employees FROM dept d;"}
{"case_id": "19", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5","sql": "LOCK TABLE emp IN EXCLUSIVE MODE NOWAIT;"}
