{"case_id": "1", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["NUMERIC","INTEGER","VARCHAR","DATE","NOW","CURRENT_TIMESTAMP"]},"sql": "CREATE TABLE employees (employee_id NUMBER(6) NOT NULL, first_name VARCHAR2(20), hire_date DATE DEFAULT SYSDATE);"}
{"case_id": "2", "difficulty_level": "3", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CREATE PROCEDURE","CREATE FUNCTION","INTEGER","SET NOCOUNT ON","@@TRANCOUNT","RAISERROR","BEGIN","DATEADD","NOW","current_timestamp","INTERVAL","@@ROWCOUNT","NUMERIC","CURSOR","BEGIN TRY","ERROR_MESSAGE","CAST","CONCAT"]},"sql": "CREATE PROCEDURE usp_UpdateOrderStatus @CustomerID INT, @OldStatus VARCHAR(20), @NewStatus VARCHAR(20), @RowsUpdated INT OUTPUT, @ErrorMessage VARCHAR(200) OUTPUT AS BEGIN SET NOCOUNT ON; DECLARE @OrderCount INT, @TranCount INT = @@TRANCOUNT; IF @OldStatus = @NewStatus BEGIN SET @ErrorMessage = '新旧状态不能相同'; RETURN 400; END BEGIN TRY IF @TranCount = 0 BEGIN TRANSACTION; UPDATE Orders SET Status = @NewStatus, LastUpdated = GETDATE() WHERE CustomerID = @CustomerID AND Status = @OldStatus AND OrderDate > DATEADD(month, -3, GETDATE()); SET @RowsUpdated = @@ROWCOUNT; IF @RowsUpdated = 0 BEGIN SET @ErrorMessage = '未找到符合条件的订单'; RETURN 404; END INSERT INTO OrderLog (OrderID, OldStatus, NewStatus, ChangeDate) SELECT OrderID, @OldStatus, @NewStatus, GETDATE() FROM Orders WHERE CustomerID = @CustomerID AND Status = @NewStatus; DECLARE @ProcessingFee DECIMAL(10,2) = 0; DECLARE fee_cursor CURSOR FOR SELECT Fee FROM OrderDetails WHERE OrderID IN (SELECT OrderID FROM Orders WHERE CustomerID = @CustomerID AND Status = @NewStatus); OPEN fee_cursor; FETCH NEXT FROM fee_cursor INTO @ProcessingFee; WHILE @@FETCH_STATUS = 0 BEGIN SET @ProcessingFee = @ProcessingFee * 0.95; FETCH NEXT FROM fee_cursor INTO @ProcessingFee; END CLOSE fee_cursor; DEALLOCATE fee_cursor; IF @TranCount = 0 COMMIT TRANSACTION; SET @ErrorMessage = '更新成功'; RETURN 200; END TRY BEGIN CATCH IF @TranCount = 0 AND @@TRANCOUNT > 0 ROLLBACK TRANSACTION; SET @ErrorMessage = ERROR_MESSAGE() + ' (Line:' + CAST(ERROR_LINE() AS VARCHAR) + ')'; RETURN 500; END CATCH END"}
{"case_id": "3", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5", "key_info":{"sys_func":["CREATE SEQUENCE"]},"sql": "CREATE SEQUENCE emp_seq START WITH 1000 INCREMENT BY 1 CACHE 20;"}
{"case_id": "4", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2",  "key_info":{"sys_func":["PROCEDURE","VARCHAR","BEGIN","OPEN FOR","uuid","CONCAT","random","NVL","COALESCE","count","NOW","CURRENT_TIMESTAMP","DO"]},"sql": "DELIMITER $$ CREATE OR REPLACE PROCEDURE \"SP_KSH_PERSON_DESC\" (V_USER_ID IN VARCHAR2, OUTCURSOR OUT SYS_REFCURSOR) IS BEGIN OPEN OUTCURSOR FOR SELECT SYS_GUID() AS UUID, v0.usr_name AS user_name, v0.dept_name, v0.position_describe AS post_name, NVL(v1.ves_cnt,0) AS ves_cnt, NVL(v1.jw_num,0) AS jw_num, NVL(v1.hw_num,0) AS hw_num FROM (SELECT su.usr_id, su.usr_name, so.office_name || so2.office_name AS dept_name, su.position_describe FROM sys_user su LEFT JOIN sys_office so ON su.department_id = so.office_id LEFT JOIN sys_office so2 ON su.dept = so2.office_code WHERE su.usr_id = V_USER_ID) v0 LEFT JOIN (SELECT COUNT(um.vessel_code) AS ves_cnt, COUNT(DISTINCT fn_get_vessel_manager_bc(um.VESSEL_CODE, SYSDATE, '1')) AS jw_num, COUNT(DISTINCT fn_get_vessel_manager_bc(um.VESSEL_CODE, SYSDATE, '2')) AS hw_num FROM ksh_user_manage_ship um WHERE um.user_id = V_USER_ID) v1 ON 1=1; END SP_KSH_PERSON_DESC; $$"}
{"case_id": "5", "difficulty_level": "1", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x",  "key_info":{"sys_func":["PG_TABLES","INTEGER","nvarchar"]},"sql": "IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'Logs') CREATE TABLE Logs (LogID int, LogMessage nvarchar(max));"}
{"case_id": "6", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["WITH READ ONLY"]},"sql": "CREATE OR REPLACE VIEW v_emp_dept AS SELECT e.ename, d.dname FROM emp e JOIN dept d ON e.deptno = d.deptno WITH READ ONLY;"}
{"case_id": "7", "difficulty_level": "2", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CREATE PROCEDURE","CREATE FUNCTION","CHAR","BEGIN"]},"sql": "CREATE PROCEDURE sp_GetCustomerOrders @CustomerID nchar(5) AS BEGIN SELECT * FROM Orders WHERE CustomerID = @CustomerID; END;"}
{"case_id": "8", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5", "key_info":{"sys_func":["CREATE INDEX","LOWER"]},"sql": "CREATE INDEX idx_emp_name ON emp(LOWER(ename));"}
{"case_id": "9", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["CREATE TRIGGER","FOR EACH ROW","BEGIN"]},"sql": "CREATE OR REPLACE TRIGGER trg_audit_emp_sal BEFORE UPDATE OF sal ON emp FOR EACH ROW BEGIN INSERT INTO emp_audit(emp_id, old_sal, new_sal) VALUES (:OLD.empno, :OLD.sal, :NEW.sal); END;"}
{"case_id": "10", "difficulty_level": "3", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CURSOR","DECLARE CURSOR","VARCHAR"]},"sql": "DECLARE @MyCursor CURSOR; DECLARE @LastName varchar(50); SET @MyCursor = CURSOR FOR SELECT LastName FROM Person.Person; OPEN @MyCursor; FETCH NEXT FROM @MyCursor INTO @LastName; CLOSE @MyCursor; DEALLOCATE @MyCursor;"}
{"case_id": "11", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5", "key_info":{"sys_func":["ALTER TABLE ADD CONSTRAINT"]},"sql": "ALTER TABLE sales ADD CONSTRAINT sales_time_fk FOREIGN KEY (time_id) REFERENCES times(time_id) ENABLE NOVALIDATE;"}
{"case_id": "12", "difficulty_level": "3", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CREATE TYPE","nvarchar","coalesce"]},"sql": "CREATE TYPE [dbo].[AccountNumber] FROM [nvarchar](15) NOT NULL;"}
{"case_id": "13", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["CREATE SCHEMA","PROCEDURE","VARCHAR","NUMERIC","INTEGER"]},"sql": "CREATE OR REPLACE PACKAGE emp_actions AS PROCEDURE hire_employee(p_name VARCHAR2, p_job VARCHAR2); FUNCTION get_salary(p_emp_id NUMBER) RETURN NUMBER; END emp_actions;"}
{"case_id": "14", "difficulty_level": "3", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CREATE PROCEDURE","CREATE FUNCTION","INTEGER","BEGIN","SET NOCOUNT ON","BEGIN TRY"]},"sql": "CREATE PROCEDURE [HumanResources].[uspUpdateEmployeePersonalInfo] @BusinessEntityID [int], @NationalIDNumber [nvarchar](15), @BirthDate [datetime] AS BEGIN SET NOCOUNT ON; BEGIN TRY UPDATE [HumanResources].[Employee] SET [NationalIDNumber] = @NationalIDNumber, [BirthDate] = @BirthDate WHERE [BusinessEntityID] = @BusinessEntityID; END TRY BEGIN CATCH EXECUTE [dbo].[uspLogError]; END CATCH; END;"}
{"case_id": "15", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5", "key_info":{"sys_func":["CREATE PROCEDURE","PRAGMA AUTONOMOUS_TRANSACTION","BEGIN","SYSDATE","COMMIT"]},"sql": "CREATE OR REPLACE PROCEDURE process_orders IS PRAGMA AUTONOMOUS_TRANSACTION; BEGIN INSERT INTO order_logs (log_date, log_msg) VALUES (SYSDATE, 'Processing started'); DELETE FROM new_orders; COMMIT; END;"}
{"case_id": "16", "difficulty_level": "2", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["DECLARE","CURSOR","BEGIN","DO"]},"sql": "DECLARE TYPE emp_cur_type IS REF CURSOR; v_cur emp_cur_type; BEGIN OPEN v_cur FOR SELECT * FROM emp; END;"}
{"case_id": "17", "difficulty_level": "3", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["XML","xmlelement","json_build_object","xmlagg"]},"sql": "SELECT OrderID, CustomerID, OrderDate FROM Orders FOR XML PATH('Order'), ROOT('Orders');"}
{"case_id": "18", "difficulty_level": "1", "source_dialect": "ORACLE", "target_dialect": "Postgresql-9.2", "key_info":{"sys_func":["SET","SET SESSION AUTHORIZATION","NLS_DATE_FORMAT","to_char","DateStyle"]},"sql": "ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS';"}
{"case_id": "19", "difficulty_level": "3", "source_dialect": "ORACLE", "target_dialect": "OceanBase的Oracle模式-4.2.5", "key_info":{"sys_func":[ "Hint","并行执行 Hint"]},"sql": "SELECT /*+ FULL(e) PARALLEL(e, 4) */ e.ename, d.dname FROM emp e, dept d WHERE e.deptno = d.deptno;"}
{"case_id": "20", "difficulty_level": "2", "source_dialect": "SQLServer", "target_dialect": "GaussDB-v2.0_3.x", "key_info":{"sys_func":["CREATE TABLE PARTITION","INTEGER"]},"sql": "CREATE PARTITION FUNCTION myRangePF1 (int) AS RANGE LEFT FOR VALUES (1, 100, 1000);"}
